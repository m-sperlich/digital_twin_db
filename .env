# =============================================================================
# XR Future Forests Lab - Supabase Environment Configuration
# =============================================================================
#
# This file is a template. Follow these steps to set up your environment:
#
# FOR LOCAL DEVELOPMENT:
#   1. Copy this file: cp .env.template .env
#   2. Run: ./utils/generate-keys.sh --write
#   3. Start Docker: docker compose up -d
#
# FOR PRODUCTION (Server Deployment):
#   See docs/supabase/setup-guide.md for detailed production configuration instructions
#
# IMPORTANT: Never commit the .env file to git! It contains secrets!
# =============================================================================

# =============================================================================
# ENVIRONMENT TYPE
# =============================================================================
# Options: development, production
ENVIRONMENT=development

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database Name (default is fine for most cases)
POSTGRES_DB=postgres

# PostgreSQL Username (default is fine for most cases)
POSTGRES_USER=postgres

# PostgreSQL Password
# DEVELOPMENT: You can use 'postgres' for local testing
# PRODUCTION: Use a strong random password (32+ characters)
# Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=6qmV4NXAsvcBbvTzNXcKLMQCcA1JIZ8h

# Database Password (same as POSTGRES_PASSWORD)
SUPABASE_DB_PASSWORD=6qmV4NXAsvcBbvTzNXcKLMQCcA1JIZ8h

# =============================================================================
# SUPABASE SECURITY KEYS (CRITICAL - MUST GENERATE)
# =============================================================================

# JWT Secret - Used to sign authentication tokens
# MUST be at least 32 characters
# Generate with: openssl rand -base64 32
# Or run: ./utils/generate-keys.sh --write
SUPABASE_JWT_SECRET=e1FHzBrYfrD/d4QnFQx1w+8tngdArMAhIHoE8LO4aZc=

# Anonymous Key - Public API key (safe to use in client applications)
# This is a JWT token signed with SUPABASE_JWT_SECRET
# Generate with: ./utils/generate-keys.sh --write
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzYyOTQ1ODc4LCJleHAiOjIwNzgzMDU4Nzh9.UHrLvVn3dezOgnjpMcArQzqfBroC9mQP35y_PrU2FFw

# Public Anonymous Key (same as SUPABASE_ANON_KEY)
PUBLIC_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzYyOTQ1ODc4LCJleHAiOjIwNzgzMDU4Nzh9.UHrLvVn3dezOgnjpMcArQzqfBroC9mQP35y_PrU2FFw

# Service Role Key - Admin API key (NEVER expose to clients!)
# This is a JWT token signed with SUPABASE_JWT_SECRET
# Generate with: ./utils/generate-keys.sh --write
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoic2VydmljZV9yb2xlIiwiaXNzIjoic3VwYWJhc2UiLCJpYXQiOjE3NjI5NDU4NzgsImV4cCI6MjA3ODMwNTg3OH0.RCQ3LUVfUtXAzx8ZFG6YNyIkBY0Q5hUVVcAgMAnMrO0

# =============================================================================
# API CONFIGURATION
# =============================================================================

# External API URL
# DEVELOPMENT: Use localhost
# PRODUCTION: Use your server domain/IP
API_EXTERNAL_URL=http://localhost:54321

# Public REST API URL
PUBLIC_REST_URL=http://localhost:54321/rest/v1

# Frontend Site URL
SITE_URL=http://localhost:3000

# =============================================================================
# SERVICE PORTS (Default values are fine for local development)
# =============================================================================

# PostgreSQL Database Port (accessible from host machine)
POSTGRES_PORT=54322

# Kong API Gateway HTTP Port (main API access point)
KONG_HTTP_PORT=54321

# Kong API Gateway HTTPS Port
KONG_HTTPS_PORT=54324

# Supabase Studio Port (database management UI)
STUDIO_PORT=54323

# =============================================================================
# S3 STORAGE CONFIGURATION (OPTIONAL - For Point Cloud Files)
# =============================================================================
#
# NOTE: S3 storage is OPTIONAL for local development and testing.
# Leave these empty if you're not working with point cloud files.
# The database will work perfectly fine without S3 configuration.
#
# Only configure S3 if you plan to:
# - Store large LiDAR point cloud files (.las, .laz)
# - Integrate with external point cloud processing services
# - Deploy to production with point cloud support
#
# =============================================================================

# Storage Backend Type
# DEVELOPMENT: Use 'file' for local filesystem storage (default)
# PRODUCTION: Use 's3' for AWS S3 or compatible service
STORAGE_BACKEND=file

# S3 Endpoint URL (leave empty if not using S3)
# DEVELOPMENT with MinIO: http://localhost:9000
# PRODUCTION with AWS: https://s3.amazonaws.com
# PRODUCTION with custom: https://your-s3-endpoint.com
S3_ENDPOINT=

# S3 Region (leave empty if not using S3)
S3_REGION=

# S3 Bucket Name (leave empty if not using S3)
# DEVELOPMENT: test-pointclouds
# PRODUCTION: xr-forests-production-pointclouds
S3_BUCKET_NAME=

# S3 Access Credentials (leave empty if not using S3)
# DEVELOPMENT with MinIO: minioadmin / minioadmin
# PRODUCTION: Get from AWS IAM or your S3 provider
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=

# =============================================================================
# AUTHENTICATION SETTINGS
# =============================================================================

# Allow new user signups
# DEVELOPMENT: true
# PRODUCTION: false (control access manually)
DISABLE_SIGNUP=false

# Enable email signup
ENABLE_EMAIL_SIGNUP=true

# Auto-confirm email addresses (skip verification)
# DEVELOPMENT: true (convenient for testing)
# PRODUCTION: false (require email verification)
ENABLE_EMAIL_AUTOCONFIRM=true

# JWT Token Expiration (in seconds)
# 3600 = 1 hour, 86400 = 24 hours
JWT_EXPIRY=3600

# =============================================================================
# SMTP EMAIL CONFIGURATION (Optional - for authentication emails)
# =============================================================================

# SMTP Host (for sending emails)
SMTP_HOST=supabase-mail

# SMTP Port
SMTP_PORT=2500

# SMTP Username
SMTP_USER=

# SMTP Password
SMTP_PASS=

# Email sender name
SMTP_SENDER_NAME=

# Admin email address
SMTP_ADMIN_EMAIL=admin@example.com

# =============================================================================
# EXTERNAL SERVICES (Optional - for advanced features)
# =============================================================================

# Additional allowed redirect URLs (comma-separated)
ADDITIONAL_REDIRECT_URLS=

# Logflare API Key (for log aggregation)
LOGFLARE_API_KEY=

# =============================================================================
# EXTERNAL API INTEGRATIONS (Forest Research Tools)
# =============================================================================

# EcoSense API Configuration (Environmental Sensor Platform)
ECOSENSE_API_URL=
ECOSENSE_API_KEY=

# 3DTreesAPI Configuration (Tree Model Generation)
THREEDTREES_API_URL=
THREEDTREES_API_KEY=

# SILVA Model Endpoint (Forest Growth Simulation)
SILVA_MODEL_ENDPOINT=
SILVA_MODEL_API_KEY=

# =============================================================================
# LOGGING AND DEBUGGING
# =============================================================================

# Log Level
# Options: debug, info, warn, error
# DEVELOPMENT: debug (verbose logging)
# PRODUCTION: info or warn
LOG_LEVEL=info

# Enable query logging (can be verbose)
# DEVELOPMENT: true
# PRODUCTION: false
ENABLE_QUERY_LOGGING=false

# =============================================================================
# BACKUP CONFIGURATION (Production Only)
# =============================================================================

# Enable automated backups
BACKUP_ENABLED=false

# Backup schedule (cron format)
# Example: "0 2 * * *" = Daily at 2 AM
BACKUP_SCHEDULE=0 2 * * *

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# =============================================================================
# SETUP NOTES
# =============================================================================
#
# REQUIRED STEPS:
# 1. Copy this file: cp .env.template .env
# 2. Run: ./utils/generate-keys.sh --write
#    This will generate secure keys for:
#    - SUPABASE_JWT_SECRET
#    - SUPABASE_ANON_KEY
#    - SUPABASE_SERVICE_ROLE_KEY
#    - POSTGRES_PASSWORD (optional, can keep as 'postgres' for local)
#
# 3. For local development, you can keep all other defaults!
#
# 4. Start Docker: docker compose up -d
#
# WHAT YOU NEED TO CHANGE:
# - Nothing! Just run ./utils/generate-keys.sh --write and you're good to go!
#
# SECURITY BEST PRACTICES:
# - Never commit .env to git
# - Never share your SUPABASE_SERVICE_ROLE_KEY publicly
# - Never use development keys in production
#
# =============================================================================
